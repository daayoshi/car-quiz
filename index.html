<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>トヨタ ミニバン判別クイズ</title>
    <style>
        /* (これまでのスタイルはそのまま維持) */
        #start-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        #start-btn { padding: 20px 40px; font-size: 24px; background: #27ae60; color: white; border: none; border-radius: 10px; cursor: pointer; }
    </style>
</head>
<body>

<div id="start-screen">
    <h1>ミニバン判別クイズ</h1>
    <p>音量をオンにして挑戦してください</p>
    <button id="start-btn" onclick="startGame()">クイズを始める</button>
</div>

<div id="quiz-container">
    <div class="stats">
        <div id="question-count">第 1 問</div>
        <div id="score-display">スコア: 0</div>
    </div>
    <div id="image-area" class="car-image-container"></div>
    <div id="answer-buttons" class="btn-container">
        <button onclick="handleAnswer('アルファード')">アルファード</button>
        <button onclick="handleAnswer('ヴェルファイア')">ヴェルファイア</button>
        <button onclick="handleAnswer('ノア')">ノア</button>
        <button onclick="handleAnswer('ヴォクシー')">ヴォクシー</button>
    </div>
    <div id="result-message"></div>
    <button id="next-btn" onclick="nextQuestion()">次の問題へ</button>
    <button id="restart-btn" onclick="restartGame()">もう一度挑戦する</button>
</div>

<audio id="sound-correct" src="sounds/correct.mp3" preload="auto"></audio>
<audio id="sound-wrong" src="sounds/wrong.mp3" preload="auto"></audio>

<script>
    // (これまでの変数設定などは維持)
    const soundCorrect = document.getElementById('sound-correct');
    const soundWrong = document.getElementById('sound-wrong');

    // ゲーム開始ボタンを押した時の処理
    function startGame() {
        // iPhoneの音の制限を解除するために一度だけ音を「再生・即停止」する
        soundCorrect.play().then(() => {
            soundCorrect.pause();
            soundCorrect.currentTime = 0;
        }).catch(e => console.log("初期再生エラー:", e));

        // スタート画面を隠す
        document.getElementById('start-screen').style.display = 'none';
        initGame(); // ここでクイズを開始
    }

    // 回答ボタンが押されたとき
    function handleAnswer(userAnswer) {
        const currentData = currentQuizSet[questionIndex];
        const buttons = document.querySelectorAll('#answer-buttons button');
        buttons.forEach(btn => btn.disabled = true);

        const resultArea = document.getElementById('result-message');
        
        if (userAnswer === currentData.name) {
            score++;
            resultArea.innerText = "正解！ ⭕️";
            resultArea.style.color = "#27ae60";
            playSound(soundCorrect); // 音を鳴らす
        } else {
            resultArea.innerText = "残念！ ❌ 正解は " + currentData.name;
            resultArea.style.color = "#e74c3c";
            playSound(soundWrong); // 音を鳴らす
        }

        document.getElementById('score-display').innerText = `スコア: ${score}`;
        document.getElementById('next-btn').style.display = "block";
    }

    // 音を確実に鳴らすための関数
    function playSound(audioElement) {
        audioElement.pause();      // 一度止める
        audioElement.currentTime = 0; // 最初に戻す
        audioElement.play().catch(e => {
            console.log("再生に失敗しました。ユーザー操作が必要です。", e);
        });
    }

    // (残りの initGame, nextQuestion 等の関数はそのまま)
</script>
</body>
</html>
