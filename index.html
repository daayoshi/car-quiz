<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ãƒˆãƒ¨ã‚¿ ãƒŸãƒ‹ãƒãƒ³åˆ¤åˆ¥ã‚¯ã‚¤ã‚º</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; text-align: center; background-color: #f0f2f5; margin: 0; padding: 20px; touch-action: manipulation; }
        
        /* ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ã‚’æœ€å‰é¢ã«ç¢ºå®Ÿã«è¡¨ç¤º */
        #start-screen { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: #ffffff; z-index: 9999; /* é‡ãªã‚Šé †ã‚’æœ€å¤§ã« */
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            padding: 20px; box-sizing: border-box; 
        }
        
        #quiz-container { background: white; width: 100%; max-width: 500px; margin: 0 auto; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); box-sizing: border-box; }
        .stats { display: flex; justify-content: space-between; margin-bottom: 15px; font-weight: bold; color: #555; }
        .car-image-container { width: 100%; height: 250px; background-color: #e0e0e0; border-radius: 10px; overflow: hidden; margin-bottom: 20px; display: flex; align-items: center; justify-content: center; }
        .car-image-container img { width: 100%; height: 100%; object-fit: cover; }
        .btn-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        button { padding: 15px 5px; font-size: 16px; cursor: pointer; border: none; border-radius: 8px; background: #2c3e50; color: white; font-weight: bold; -webkit-tap-highlight-color: transparent; }
        button:active { background: #1a252f; opacity: 0.8; }
        
        /* ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        #start-btn { margin-top: 30px; width: 80%; max-width: 300px; background: #27ae60; padding: 20px; font-size: 20px; z-index: 10000; }
        
        .sound-setting { margin: 20px 0; font-size: 18px; display: flex; align-items: center; gap: 15px; cursor: pointer; padding: 10px; border: 1px solid #ddd; border-radius: 10px; }
        .sound-setting input { width: 25px; height: 25px; }
        #result-message { margin-top: 20px; font-size: 18px; font-weight: bold; min-height: 24px; }
    </style>
</head>
<body>

<div id="start-screen">
    <h1 style="color:#2c3e50;">ãƒŸãƒ‹ãƒãƒ³åˆ¤åˆ¥ã‚¯ã‚¤ã‚º</h1>
    <p>å…¨10å•ã€ä½•å•æ­£è§£ã§ãã‚‹ã‹ãªï¼Ÿ</p>
    
    <label class="sound-setting">
        <input type="checkbox" id="sound-toggle" checked>
        <span>ğŸ”Š ã‚µã‚¦ãƒ³ãƒ‰ã‚’æœ‰åŠ¹ã«ã™ã‚‹</span>
    </label>

    <button id="start-btn" onclick="startGame()">ã‚¯ã‚¤ã‚ºã‚’å§‹ã‚ã‚‹</button>
</div>

<div id="quiz-container">
    <div class="stats">
        <div id="question-count">ç¬¬ 1 å• / 10</div>
        <div id="score-display">ã‚¹ã‚³ã‚¢: 0</div>
    </div>
    <div id="image-area" class="car-image-container">ç”»åƒèª­ã¿è¾¼ã¿ä¸­...</div>
    <div class="btn-container" id="answer-buttons">
        <button onclick="handleAnswer('ã‚¢ãƒ«ãƒ•ã‚¡ãƒ¼ãƒ‰')">ã‚¢ãƒ«ãƒ•ã‚¡ãƒ¼ãƒ‰</button>
        <button onclick="handleAnswer('ãƒ´ã‚§ãƒ«ãƒ•ã‚¡ã‚¤ã‚¢')">ãƒ´ã‚§ãƒ«ãƒ•ã‚¡ã‚¤ã‚¢</button>
        <button onclick="handleAnswer('ãƒã‚¢')">ãƒã‚¢</button>
        <button onclick="handleAnswer('ãƒ´ã‚©ã‚¯ã‚·ãƒ¼')">ãƒ´ã‚©ã‚¯ã‚·ãƒ¼</button>
    </div>
    <div id="result-message"></div>
    <button id="next-btn" style="display:none; background:#27ae60; margin-top:20px; width:100%;" onclick="nextQuestion()">æ¬¡ã®å•é¡Œã¸</button>
    <button id="restart-btn" style="display:none; background:#2980b9; margin-top:20px; width:100%;" onclick="restartGame()">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>
</div>

<audio id="sound-correct" src="sounds/correct.mp3" preload="auto"></audio>
<audio id="sound-wrong" src="sounds/wrong.mp3" preload="auto"></audio>

<script>
    const carTypes = [
        { name: "ã‚¢ãƒ«ãƒ•ã‚¡ãƒ¼ãƒ‰", folder: "alphard" },
        { name: "ãƒ´ã‚§ãƒ«ãƒ•ã‚¡ã‚¤ã‚¢", folder: "vellfire" },
        { name: "ãƒã‚¢", folder: "noah" },
        { name: "ãƒ´ã‚©ã‚¯ã‚·ãƒ¼", folder: "voxy" }
    ];
    const imagesPerCar = 20;
    const quizCount = 10;
    let allImages = [];
    let currentQuizSet = [];
    let score = 0;
    let questionIndex = 0;
    let isSoundEnabled = true;

    function startGame() {
        console.log("Start button clicked"); // ãƒ‡ãƒãƒƒã‚°ç”¨
        isSoundEnabled = document.getElementById('sound-toggle').checked;
        
        const soundCorrect = document.getElementById('sound-correct');
        if (isSoundEnabled) {
            soundCorrect.play().then(() => {
                soundCorrect.pause();
                soundCorrect.currentTime = 0;
            }).catch(e => console.log("Unlock failed", e));
        }
        
        document.getElementById('start-screen').style.display = 'none';
        initGame();
    }

    function initGame() {
        score = 0;
        questionIndex = 0;
        allImages = [];
        carTypes.forEach(car => {
            for (let i = 1; i <= imagesPerCar; i++) {
                allImages.push({ name: car.name, img: car.folder + "/" + i + ".jpg" });
            }
        });
        currentQuizSet = allImages.sort(() => Math.random() - 0.5).slice(0, quizCount);
        showQuestion();
    }

    function showQuestion() {
        const currentData = currentQuizSet[questionIndex];
        document.getElementById('question-count').innerText = `ç¬¬ ${questionIndex + 1} å• / ${quizCount}`;
        document.getElementById('result-message').innerText = "";
        document.getElementById('next-btn').style.display = "none";
        document.querySelectorAll('#answer-buttons button').forEach(btn => btn.disabled = false);
        document.getElementById('image-area').innerHTML = `<img src="${currentData.img}" onerror="this.parentNode.innerHTML='ç”»åƒãªã—<br>${currentData.img}'">`;
    }

    function handleAnswer(userAnswer) {
        const currentData = currentQuizSet[questionIndex];
        document.querySelectorAll('#answer-buttons button').forEach(btn => btn.disabled = true);
        const resultArea = document.getElementById('result-message');
        
        if (userAnswer === currentData.name) {
            score++;
            resultArea.innerText = "æ­£è§£ï¼ â­•ï¸";
            resultArea.style.color = "#27ae60";
            if (isSoundEnabled) playSound(document.getElementById('sound-correct'));
        } else {
            resultArea.innerText = "æ®‹å¿µï¼ âŒ æ­£è§£ã¯ " + currentData.name;
            resultArea.style.color = "#e74c3c";
            if (isSoundEnabled) playSound(document.getElementById('sound-wrong'));
        }
        document.getElementById('score-display').innerText = `ã‚¹ã‚³ã‚¢: ${score}`;
        document.getElementById('next-btn').style.display = "block";
    }

    function playSound(audio) {
        audio.pause();
        audio.currentTime = 0;
        audio.play().catch(e => console.log("Play failed", e));
    }
